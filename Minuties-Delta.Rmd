---
title: "Minuties-Delta"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load Data, echo=FALSE, include=FALSE, warning=FALSE}
# Préparation des données avec séparations entre deltas propre, de pouce et zone de controle----

data = read.csv( paste(getwd(), "/data_all.csv",sep="" )) ## 48434 obs, 16 var
```

```{r Data summary, warning=FALSE}
summary(data[,2:4])
```

```{r Work on Data, echo=FALSE, include=FALSE, warning=FALSE}
library(dplyr) # mutate
library(mosaic) # rad2deg
library(spatstat) # ppp, Kest


data = mutate( data, xc = x.minut - x.centre )
data = mutate( data, yc = y.minut - y.centre ) 
data = mutate( data, angle.correction = rad2deg(angle.correction))
data = mutate( data, t.minut=(t.minut+180)%%360)
data = mutate( data, tc = t.minut - angle.correction)
data = mutate( data, angle.bc = ((360-angle.b)-(360-angle.c)))
data = mutate( data, theta = tc - phi) #nouveau: est adapté à l'angle de position de la minutie

for (i in 1:nrow(data)) {
  if (data[i,20] < 0) {
    data[i,20] = data[i,20] + 360 
  } 
  if (data[i,16] < 0){
    data[i,16] = data[i,16] + 360
  }
}

pouceD = subset(data, type=="delta de pouce" & d.g=="droit")
pouceG = subset(data, type=="delta de pouce" & d.g=="gauche")
propreD = subset(data, type=="delta propre" & d.g=="droit")
propreG = subset(data, type=="delta propre" & d.g=="gauche")
controlD = subset(data, type=="zone de controle" & d.g=="droit")
controlG = subset(data, type=="zone de controle" & d.g=="gauche")

```

## The data - Disc of diameter 15 mm

```{r plot data full, echo=FALSE, warning=FALSE}
# Préparation des données avec séparations entre deltas propre, de pouce et zone de controle----

ppouceDd15 = ppp(pouceD[,17],pouceD[,18], disc(7.5)) ; ppouceGd15 = ppp(pouceG[,17],pouceG[,18], disc(7.5))
ppropreDd15 = ppp(propreD[,17],propreD[,18], disc(7.5)) ; ppropreGd15 = ppp(propreG[,17],propreG[,18], disc(7.5))
pcontrolDd15 = ppp(controlD[,17],controlD[,18], disc(7.5)) ; pcontrolGd15 = ppp(controlG[,17],controlG[,18], disc(7.5))

layout(matrix(c(1,2,3,4,5,6),nrow=2,ncol=3))
par(oma = c(0,5,0,0) + 0.1,mar = c(0,0,0.9,0) + 0.1)
plot(ppouceDd15,main="Thumb delta",cex.main=1, ylab="RIGHT", border=rgb(0,0,1))
plot(ppouceGd15,main="", border=rgb(0,0,1)) 
plot(ppropreDd15,main="Clean delta", border=rgb(0,0,1));plot(ppropreGd15,main="", border=rgb(0,0,1))
plot(pcontrolDd15,main="Control zone", border=rgb(0,0,1));plot(pcontrolGd15,main="", border=rgb(0,0,1))
title("", cex.main=2, outer=TRUE, font.lab=2, ylab="Left Hand                                      Right Hand",cex.lab=1.2)

```

These are the minutiaes around the delta for 100 deltas on thumbs with a 

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
