---
title: "Minuties-Delta"
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
output: pdf_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## The data

100 fingerprint cards were choosen in order to get both thumbs having ulnar loops with at least 20 ridges between the delta and the core of the loop. The same was made to get cards with the clean delta and a control zone on each of the palms. The control zone was defined as a zone were the flow of the ridge is straight and parrallel situated in the thenar zone, just over the thumb.

These different zones were extracted and croped with a 3 x 3 cm square. The part containing a delta were centered on it and the upper axis was placed north. For the control zone, the square was aligned with the edge of the print and the upper part on the middle line.

For each image the minutiaes were annotated with their position and the orientation. These are represented in the plots separated by zones and hand.


```{r load Data, echo=FALSE, include=FALSE, warning=FALSE}
# Préparation des données avec séparations entre deltas propre, de pouce et zone de controle----

data = read.csv( paste(getwd(), "/data_all.csv",sep="" )) ## 48434 obs, 16 var

library(ggplot2)
library(dplyr) # mutate
library(mosaic) # rad2deg
library(spatstat) # ppp, Kest
library(gridExtra) # tableGrob
library(fmsb) # radar chart


data = mutate( data, xc = x.minut - x.centre )
data = mutate( data, yc = y.minut - y.centre )
data = mutate( data, angle.correction = rad2deg(angle.correction))
data = mutate( data, t.minut=(t.minut+180)%%360)
data = mutate( data, tc = t.minut - angle.correction)
data = mutate( data, angledif.bc = ((360-angle.b)-(360-angle.c)))
data = mutate( data, theta = tc - phi) #nouveau: est adapté à l'angle de position de la minutie

# Modification / ajout CG
data = mutate( data, phi = (phi + angle.correction - 90)%%360) #intégration de la correction pour phi
data = mutate( data, angle.a = angle.a -90)
data = mutate( data, angle.b = angle.b -90)
data = mutate( data, angle.c = (angle.c -90)%%360)

data = mutate( data, angle.ab = (angle.a + angle.b)/2)
data = mutate( data, angle.bc = (angle.b + angle.c)/2)
data = mutate( data, angle.ca = (angle.c + (360 - angle.c)/2))

for (i in 1:nrow(data)) {
  if (data[i,"angledif.bc"] < 0) {
    data[i,"angledif.bc"] = data[i,"angledif.bc"] + 360 
  } 
  if (data[i,"theta"] < 0){
    data[i,"theta"] = data[i,"theta"] + 360
  }
}

pouceD = subset(data, type=="delta de pouce" & d.g=="droit")
pouceG = subset(data, type=="delta de pouce" & d.g=="gauche")
propreD = subset(data, type=="delta propre" & d.g=="droit")
propreG = subset(data, type=="delta propre" & d.g=="gauche")
controlD = subset(data, type=="zone de controle" & d.g=="droit")
controlG = subset(data, type=="zone de controle" & d.g=="gauche")

```


```{r plot data full, echo=FALSE, warning=FALSE}
# Préparation des données avec séparations entre deltas propre, de pouce et zone de controle----

ppouceDd15 = ppp(pouceD[,17],pouceD[,18], disc(8)) ; ppouceGd15 = ppp(pouceG[,17],pouceG[,18], disc(8))
ppropreDd15 = ppp(propreD[,17],propreD[,18], disc(8)) ; ppropreGd15 = ppp(propreG[,17],propreG[,18], disc(8))
pcontrolDd15 = ppp(controlD[,17],controlD[,18], disc(8)) ; pcontrolGd15 = ppp(controlG[,17],controlG[,18], disc(8))

layout(matrix(c(1,2,3,4,5,6),nrow=2,ncol=3))
par(oma = c(0,5,0,0) + 0.1,mar = c(0,0,0.9,0) + 0.1)
plot(ppouceDd15,main="Thumb delta",cex.main=1, ylab="RIGHT", border=rgb(0,1,0))
plot(ppouceGd15,main="", border=rgb(0,1,0)) 
plot(ppropreDd15,main="Clean delta", border=rgb(0,1,0));plot(ppropreGd15,main="", border=rgb(0,1,0))
plot(pcontrolDd15,main="Control zone", border=rgb(0,1,0));plot(pcontrolGd15,main="", border=rgb(0,1,0))
title("", cex.main=2, outer=TRUE, font.lab=2, ylab="Left Hand                                      Right Hand",cex.lab=1.2)

```

The green circle is the window in which the analysis will be made. The diameter is of 1.6 cm which allows to avoid the problem of edge effects. The points out of this window won't be used for the analysis.

\newpage

## CSR testing

A CSR test (Complete Spatial Randomness) was done on each print individually. This was made using a second order K test accordingly to what was done in Chen and Moon 2006. 

```{r plot CSR, echo=FALSE, warning=FALSE, fig.height=1.1, fig.width=2.97, fig.align="center", fig.show="hold"}
CSR <- function(data,name, plot = TRUE, summary = TRUE){
  r<- seq(0,8, by=0.01) ; CSR=0 ; cluster = 0 ; dispersed = 0 ; cluster2 = 0 ; dispersed2 = 0 ; test = data.frame()
  
  for (i in unique(data[,1])){
    datau = data.frame()
    for (j in 1:nrow(data)){
      if (data[j,1] == i){datau=rbind(datau,data[j,])}}
    ppp = ppp(datau[,17],datau[,18],disc(8))
    k=Kest(ppp,correction="Ripley",var.approx = TRUE,ratio= TRUE)
    
    n=1 ; d=0 ; c=0 ; csr=0 ; d2=0 ; c2=0
    for (r in k$r) {
      if (k$iso[n] - pi * r^2 < -2*sqrt(k$rip[n])) {d=d+1}
      else if (k$iso[n] - pi * r^2 > 2*sqrt(k$rip[n])) {c=c+1}
      else csr=csr+1
      
      if (k$iso[n] - pi * r^2 < -2*sqrt(k$rip[n]) & k$r[n]>2.5) {d2=d2+1}
      else if (k$iso[n] - pi * r^2 > 2*sqrt(k$rip[n]) & k$r[n]>2.5) {c2=c2+1}
      
      n=n+1
      if (csr==length(k$r)){CSR=CSR+1}
    }
    
    test=rbind(test,c(i,round(d/length(k$r)*100,1),round(csr/length(k$r)*100,1),round(c/length(k$r)*100,1)))
    if (c>d){cluster=cluster + 1}
    else if (c<d){dispersed=dispersed+1}
    
    if (c2>d2){cluster2=cluster2 + 1}
    else if (c2<d2){dispersed2=dispersed2+1}
  
  
  if (plot) {
    layout(matrix(c(seq(1,9,2),seq(2,10,2),seq(11,19,2),seq(12,20,2),seq(21,29,2),seq(22,30,2),seq(31,39,2),seq(32,40,2)),nrow=5,ncol=8))
    par(oma=c(0,0,1.5,0)+0.1,mar=c(2,1.5,1,0)+0.1)
    plot(ppp,main=i,cex=0.5)
    
    # c(-ceiling(max(c(2*sqrt(k$rip),k$t-pi * k$r^2))),ceiling(max(c(2*sqrt(k$rip),k$t-pi * k$r^2))))
    plot(k,. - pi * r^2 ~ r,ylim=c(-15,15),main="",ylab="",xlab="",legend=FALSE)
    lines(matrix(c(k$r,2*sqrt(k$rip)),ncol=2),lty=2,col="red") ; lines(matrix(c(k$r,-2*sqrt(k$rip)),ncol=2),lty=2,col="red")
    # mtext(name, outer=TRUE,  cex=1, line=0)
    }
    }
  
  if (summary){
    colnames(test)=c("ID","Dis", "CSR", "Clu")
  
    mytheme <- gridExtra::ttheme_default(
      core = list(fg_params=list(cex = 0.75)),
      colhead = list(fg_params=list(cex = 1.0)),
      rowhead = list(fg_params=list(cex = 1.0)))
  
    t1=tableGrob(test[seq(1,20),],rows=NULL, theme = mytheme)
    t2=tableGrob(test[seq(21,40),],rows=NULL, theme = mytheme)
    t3=tableGrob(test[seq(41,60),],rows=NULL, theme = mytheme)
    t4=tableGrob(test[seq(61,80),],rows=NULL, theme = mytheme)
    t5=tableGrob(test[seq(81,100),],rows=NULL, theme = mytheme)
    grid.arrange(t1,t2,t3,t4,t5, ncol=5)
    
    # mtext(name, outer=TRUE,  cex=1, line=-0)
  }
  
  return (c(CSR,dispersed2,cluster2,dispersed,cluster))
  
  # mtext(name, outer=TRUE,  cex=1, line=-0)
  # mtext(paste(CSR," total CSR distributions, ",cluster," clustering and ",dispersed," dispersed",sep=""),outer = TRUE, cex=1,line=-52)
  # mtext(paste("Over 2.5 mm, ",cluster2," clustering and ",dispersed2," dispersed",sep=""),outer = TRUE, cex=1,line=-54)
  
}

datapouced = CSR(pouceD,"PouceD",plot=FALSE, summary=FALSE) # 17
datapouceg = CSR(pouceG,"PouceG",plot=FALSE, summary=FALSE) # 7
datapropred = CSR(propreD,"PropreD",plot=FALSE, summary=FALSE) # 29
datapropreg = CSR(propreG,"PropreG",plot=FALSE, summary=FALSE) # 24
datacontrold = CSR(controlD,"ControlD",plot=FALSE, summary=FALSE) # 69
datacontrolg = CSR(controlG,"ControlG",plot=FALSE, summary=FALSE) # 74

datafin=as.data.frame(matrix(0, ncol = 4, nrow = 3))

datafin[1,2] = datapouced[1] ; datafin[1,3] = datapouceg[1]
datafin[2,2] = datapropred[1] ; datafin[2,3] = datapropreg[1]
datafin[3,2] = datacontrold[1] ; datafin[3,3] = datacontrolg[1]

datafin[1,4] = paste((datafin[1,2]+datafin[1,3]), " (", ((datafin[1,2]+datafin[1,3])/2)," %)",sep="")
datafin[2,4] = paste((datafin[2,2]+datafin[2,3]), " (", ((datafin[2,2]+datafin[2,3])/2)," %)",sep="")
datafin[3,4] = paste((datafin[3,2]+datafin[3,3]), " (", ((datafin[3,2]+datafin[3,3])/2)," %)",sep="")
colnames(datafin) = c("", "Droit", "Gauche", "total (%)") ; datafin[1,1] = "Pouce" ; datafin[2,1] = "Propre" ; datafin[3,1] = "Control"

datafin2=as.data.frame(matrix(0, ncol = 4, nrow = 3))

datafin2[1,2] = (100 - (datapouced[2] + datapouced[3]))     ; datafin2[1,3] = (100 - (datapouceg[2] + datapouceg[3]))
datafin2[2,2] = (100 - (datapropred[2] + datapropred[3]))   ; datafin2[2,3] = (100 - (datapropreg[2] + datapropreg[3]))
datafin2[3,2] = (100 - (datacontrold[2] + datacontrold[3])) ; datafin2[3,3] = (100 - (datacontrolg[2] + datacontrolg[3]))

datafin2[1,4] = paste((datafin2[1,2]+datafin2[1,3]), " (", ((datafin2[1,2]+datafin2[1,3])/2)," %)",sep="")
datafin2[2,4] = paste((datafin2[2,2]+datafin2[2,3]), " (", ((datafin2[2,2]+datafin2[2,3])/2)," %)",sep="")
datafin2[3,4] = paste((datafin2[3,2]+datafin2[3,3]), " (", ((datafin2[3,2]+datafin2[3,3])/2)," %)",sep="")
colnames(datafin2) = c("", "Droit", "Gauche", "total (%)") ; datafin2[1,1] = "Pouce" ; datafin2[2,1] = "Propre" ; datafin2[3,1] = "Control"

plot(tableGrob(datafin,rows=NULL))
plot(tableGrob(datafin2,rows=NULL))
```

djiodjvid

```{r plot Disp/Clust, echo=FALSE, warning=FALSE, fig.height=1.1, fig.width=4.29, fig.align="center"}

datafin3=as.data.frame(matrix(0, ncol = 4, nrow = 3))

datafin3[1,2] = paste(datapouced[4],"/",datapouced[5]) ; datafin3[1,3] = paste(datapouceg[4],"/",datapouceg[5])
datafin3[2,2] = paste(datapropred[4],"/",datapropred[5]) ; datafin3[2,3] = paste(datapropreg[4],"/",datapropreg[5])
datafin3[3,2] = paste(datacontrold[4],"/",datacontrold[5]) ; datafin3[3,3] = paste(datacontrolg[4],"/",datacontrolg[5])

datafin3[1,4] = paste(((datapouced[4]+datapouceg[4])/2), "/", paste(((datapouced[5]+datapouceg[5])/2), 
                                                                      " (", ((datapouced[4]+datapouceg[4])/2), " % /", ((datapouced[5]+datapouceg[5])/2)," %)",sep=""))
datafin3[2,4] = paste(((datapropred[4]+datapropreg[4])/2), "/", paste(((datapropred[5]+datapropreg[5])/2),
                                                                        " (", ((datapropred[4]+datapropreg[4])/2), " % /", ((datapropred[5]+datapropreg[5])/2)," %)",sep=""))
datafin3[3,4] = paste(((datacontrold[4]+datacontrolg[4])/2), "/", paste(((datacontrold[5]+datacontrolg[5])/2),
                                                                        " (", ((datacontrold[4]+datacontrolg[4])/2), " % /", ((datacontrold[5]+datacontrolg[5])/2)," %)",sep=""))
colnames(datafin3) = c("", "Droit", "Gauche", "total (%)") ; datafin3[1,1] = "Pouce" ; datafin3[2,1] = "Propre" ; datafin3[3,1] = "Control"

plot(tableGrob(datafin3,rows=NULL))
```

dvsduvhiuvs

```{r plot Disp/Clust 2, echo=FALSE, warning=FALSE, fig.height=1.1, fig.width=3.98, fig.align="center"}
datafin4=as.data.frame(matrix(0, ncol = 4, nrow = 3))

datafin4[1,2] = paste(datapouced[2],"/",datapouced[3]) ; datafin4[1,3] = paste(datapouceg[2],"/",datapouceg[3])
datafin4[2,2] = paste(datapropred[2],"/",datapropred[3]) ; datafin4[2,3] = paste(datapropreg[2],"/",datapropreg[3])
datafin4[3,2] = paste(datacontrold[2],"/",datacontrold[3]) ; datafin4[3,3] = paste(datacontrolg[2],"/",datacontrolg[3])

datafin4[1,4] = paste(((datapouced[2]+datapouceg[2])/2), "/", paste(((datapouced[3]+datapouceg[3])/2), 
                    " (", ((datapouced[2]+datapouceg[2])/2), " % /", ((datapouced[3]+datapouceg[3])/2)," %)",sep=""))
datafin4[2,4] = paste(((datapropred[2]+datapropreg[2])/2), "/", paste(((datapropred[3]+datapropreg[3])/2),
                    " (", ((datapropred[2]+datapropreg[2])/2), " % /", ((datapropred[3]+datapropreg[3])/2)," %)",sep=""))
datafin4[3,4] = paste(((datacontrold[2]+datacontrolg[2])/2), "/", paste(((datacontrold[5]+datacontrolg[5])/2),
                    " (", ((datacontrold[2]+datacontrolg[2])/2), " % /", ((datacontrold[3]+datacontrolg[3])/2)," %)",sep=""))
colnames(datafin4) = c("", "Droit", "Gauche", "total (%)") ; datafin4[1,1] = "Pouce" ; datafin4[2,1] = "Propre" ; datafin4[3,1] = "Control"

plot(tableGrob(datafin4,rows=NULL))
```

\blandscape


```{r plot radar function, echo=FALSE, warning=FALSE, fig.height=1.1, fig.width=3.98, fig.align="center"}
for (i in 1:nrow(data)) {
  if (data[i,"delta"] == "delta"){
    if      (data[i,"angle.a"]  < data[i,"phi"] & data[i,"phi"] < data[i,"angle.ab"]) {data[i,24] = "aab"
    if(-4 <= data[i,"xc"])                            {data[i,25] = 1} #17 = xc ; 18 = yc
    else if(-8 <= data[i,"xc"] & data[i,"xc"] < -4)  {data[i,25] = 2}
    else if(data[i,"xc"] < -8)                       {data[i,25] = 3}}
  
    else if (data[i,"angle.ab"] < data[i,"phi"] & data[i,"phi"] < data[i,"angle.b"])  {data[i,24] = "abb"
    if(data[i,"yc"] <= data[i,"xc"]*tan(deg2rad(data[i,"angle.b"]+90)) + 4/sin(deg2rad(data[i,"angle.b"])))                    {data[i,25] = 1}
    else if(          (data[i,"xc"]*tan(deg2rad(data[i,"angle.b"]+90)) + 4/sin(deg2rad(data[i,"angle.b"]))) < data[i,"yc"] & 
                      data[i,"yc"] <= data[i,"xc"]*tan(deg2rad(data[i,"angle.b"]+90)) + 8/sin(deg2rad(data[i,"angle.b"])))    {data[i,25] = 2}
    else if(          (data[i,"xc"]*tan(deg2rad(data[i,"angle.b"]+90)) + 8/sin(deg2rad(data[i,"angle.b"]))) < data[i,"yc"])    {data[i,25] = 3}}
    
    else if (data[i,"angle.b"]  < data[i,"phi"] & data[i,"phi"] < data[i,"angle.bc"]) {data[i,24] = "bbc"
    if(data[i,"xc"]*tan(deg2rad(data[i,"angle.b"]+90)) - 4/sin(deg2rad(data[i,"angle.b"])) <= data[i,"yc"])                    {data[i,25] = 1}
    else if(          (data[i,"xc"]*tan(deg2rad(data[i,"angle.b"]+90)) -8/sin(deg2rad(data[i,"angle.b"]))) < data[i,"yc"] & 
                      data[i,"yc"] <= data[i,"xc"]*tan(deg2rad(data[i,"angle.b"]+90)) - 4/sin(deg2rad(data[i,"angle.b"])))    {data[i,25] = 2}
    else if(          (data[i,"yc"] < data[i,"xc"]*tan(deg2rad(data[i,"angle.b"]+90)) - 8/sin(deg2rad(data[i,"angle.b"]))))    {data[i,25] = 3}}
    
    else if (data[i,"angle.bc"] < data[i,"phi"] & data[i,"phi"] < data[i,"angle.c"])  {data[i,24] = "bcc"
    if(data[i,"xc"]*tan(deg2rad(data[i,"angle.c"]+90)) + 4/sin(deg2rad(data[i,"angle.c"])) <= data[i,"yc"])                    {data[i,25] = 1}
    else if(          (data[i,"xc"]*tan(deg2rad(data[i,"angle.c"]+90)) + 8/sin(deg2rad(data[i,"angle.c"]))) < data[i,"yc"] & 
                      data[i,"yc"] <= data[i,"xc"]*tan(deg2rad(data[i,"angle.c"]+90)) + 4/sin(deg2rad(data[i,"angle.c"])))    {data[i,25] = 2}
    else if(          (data[i,"yc"] < data[i,"xc"]*tan(deg2rad(data[i,"angle.c"]+90)) + 8/sin(deg2rad(data[i,"angle.c"]))))    {data[i,25] = 3}}
    
    else if (data[i,"angle.c"]  < data[i,"phi"] & data[i,"phi"] < data[i,"angle.ca"]) {data[i,24] = "cca"
    if(data[i,"yc"] <= data[i,"xc"]*tan(deg2rad(data[i,"angle.c"]+90)) - 4/sin(deg2rad(data[i,"angle.c"])))                    {data[i,25] = 1}
    else if(          (data[i,"xc"]*tan(deg2rad(data[i,"angle.c"]+90)) - 4/sin(deg2rad(data[i,"angle.c"]))) < data[i,"yc"] & 
                      data[i,"yc"] <= data[i,"xc"]*tan(deg2rad(data[i,"angle.c"]+90)) - 8/sin(deg2rad(data[i,"angle.c"])))    {data[i,25] = 2}
    else if(          (data[i,"xc"]*tan(deg2rad(data[i,"angle.c"]+90)) - 8/sin(deg2rad(data[i,"angle.c"]))) < data[i,"yc"])    {data[i,25] = 3}}
    
    else if (data[i,"angle.ca"] < data[i,"phi"] & data[i,"phi"] < data[i,"angle.a"]+360)  {data[i,24] = "caa"
    if(data[i,"xc"] <= 4)                           {data[i,25] = 1}
    else if(4 < data[i,"xc"] & data[i,"xc"] <= 8)  {data[i,25] = 2}
    else if(8 < data[i,"xc"])                      {data[i,25] = 3}}
    
    else if (data[i,"phi"] == data[i,"angle.a"]) {data[i,24] = "a"}
    else if (data[i,"phi"] == data[i,"angle.b"]) {data[i,24] = "b"}
    else if (data[i,"phi"] == data[i,"angle.c"]) {data[i,24] = "c"}
    
    else if (data[i,"phi"] == data[i,"angle.ab"]) {data[i,24] = "ab"}
    else if (data[i,"phi"] == data[i,"angle.bc"]) {data[i,24] = "bc"}
    else if (data[i,"phi"] == data[i,"angle.ca"]) {data[i,24] = "ca"}
    
    else {print ("Error")}
    }}


radar3.angle <- function (data, zone, main, angle, title) {
  
  # for (i in c("aab","abb","bbc","bcc","cca","caa")){
  #   if (angle==i){ 
  #     tmp1 = subset(data, type==zone & d.g==main & V24=="aab" & V25==1) 
  #     tmp2 = subset(data, type==zone & d.g==main & V24=="aab" & V25==2)
  #     tmp3 = subset(data, type==zone & d.g==main & V24=="aab" & V25==3)}
  # } ### à mettre tout à la fin
  
  if (angle=="aab"){
    tmp1 = subset(data, type==zone & d.g==main & V24=="aab" & V25==1)
    tmp2 = subset(data, type==zone & d.g==main & V24=="aab" & V25==2)
    tmp3 = subset(data, type==zone & d.g==main & V24=="aab" & V25==3)}

  else if (angle=="abb"){
    tmp1 = subset(data, type==zone & d.g==main & V24=="abb" & V25==1)
    tmp2 = subset(data, type==zone & d.g==main & V24=="abb" & V25==2)
    tmp3 = subset(data, type==zone & d.g==main & V24=="abb" & V25==3)}

  else if (angle=="bbc"){
    tmp1 = subset(data, type==zone & d.g==main & V24=="bbc" & V25==1)
    tmp2 = subset(data, type==zone & d.g==main & V24=="bbc" & V25==2)
    tmp3 = subset(data, type==zone & d.g==main & V24=="bbc" & V25==3)}

  else if (angle=="bcc"){
    tmp1 = subset(data, type==zone & d.g==main & V24=="bcc" & V25==1)
    tmp2 = subset(data, type==zone & d.g==main & V24=="bcc" & V25==2)
    tmp3 = subset(data, type==zone & d.g==main & V24=="bcc" & V25==3)}

  else if (angle=="cca"){
    tmp1 = subset(data, type==zone & d.g==main & V24=="cca" & V25==1)
    tmp2 = subset(data, type==zone & d.g==main & V24=="cca" & V25==2)
    tmp3 = subset(data, type==zone & d.g==main & V24=="cca" & V25==3)}

  else if (angle=="caa"){
    tmp1 = subset(data, type==zone & d.g==main & V24=="caa" & V25==1)
    tmp2 = subset(data, type==zone & d.g==main & V24=="caa" & V25==2)
    tmp3 = subset(data, type==zone & d.g==main & V24=="caa" & V25==3)}
  
  # print(nrow(tmp1));print(nrow(tmp2));print(nrow(tmp3))
  
  
  radar.tmp1 = as.data.frame(matrix(0,ncol=36)) ;colnames(radar.tmp1)=c(seq(90,350,10),seq(0,80,10))
  radar.tmp2 = as.data.frame(matrix(0,ncol=36)) ;colnames(radar.tmp2)=c(seq(90,350,10),seq(0,80,10))
  if (nrow(tmp3) != 0) {radar.tmp3 = as.data.frame(matrix(0,ncol=36)) ;colnames(radar.tmp3)=c(seq(90,350,10),seq(0,80,10))}
  
  #print("Test 0")
  
  if (angle=="aab" | angle=="caa"){ 
    for (i in tmp1[,19]) { radar.tmp1[1,round(i/10-9)%%36+1] = radar.tmp1[1,round(i/10-9)%%36+1]+1 } # 19 = tc
    for (i in tmp2[,19]) { radar.tmp2[1,round(i/10-9)%%36+1] = radar.tmp2[1,round(i/10-9)%%36+1]+1 }
    if (nrow(tmp3) != 0) {for (i in tmp3[,19]) { radar.tmp3[1,round(i/10-9)%%36+1] = radar.tmp3[1,round(i/10-9)%%36+1]+1 }}
    
    radar.tmp1 = radar.tmp1 / sum(radar.tmp1)*100 ; radar.tmp2 = radar.tmp2 / sum(radar.tmp2)*100 
    if (nrow(tmp3) != 0) {radar.tmp3 = radar.tmp3 / sum(radar.tmp3)*100
    radar.tmp=rbind(rep(30,15) ,rep(0,15) , radar.tmp1, radar.tmp2, radar.tmp3, c(30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)) }
    else {radar.tmp=rbind(rep(30,15) ,rep(0,15) , radar.tmp1, radar.tmp2, c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0), c(30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0))}}
  
  else if (angle=="abb" | angle == "bbc"){#print("Test 1")
    for (i in 1:nrow(tmp1)) { radar.tmp1[1,round((tmp1[i,19]-tmp1[i,12]+120)/10-9)%%36+1] = radar.tmp1[1,round((tmp1[i,19]-tmp1[i,12]+120)/10-9)%%36+1]+1 }
    for (i in 1:nrow(tmp2)) { radar.tmp2[1,round((tmp2[i,19]-tmp2[i,12]+120)/10-9)%%36+1] = radar.tmp2[1,round((tmp2[i,19]-tmp2[i,12]+120)/10-9)%%36+1]+1 }
    if (nrow(tmp3) != 0) {for (i in 1:nrow(tmp3)) { radar.tmp3[1,round((tmp3[i,19]-tmp3[i,12]+120)/10-9)%%36+1] = radar.tmp3[1,round((tmp3[i,19]-tmp3[i,12]+120)/10-9)%%36+1]+1 }}
    
    #print("Test 2")
    
    radar.tmp1 = radar.tmp1 / sum(radar.tmp1)*100 ; radar.tmp2 = radar.tmp2 / sum(radar.tmp2)*100 
    if (nrow(tmp3) != 0) {radar.tmp3 = radar.tmp3 / sum(radar.tmp3)*100
    radar.tmp=rbind(rep(30,15) ,rep(0,15) , radar.tmp1, radar.tmp2 , radar.tmp3, c(0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0)) }
    else {radar.tmp=rbind(rep(30,15) ,rep(0,15) , radar.tmp1, radar.tmp2 , c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0), c(0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0))}}
  
  else if (angle=="bcc" | angle=="cca"){#print("Test 1")
    for (i in 1:nrow(tmp1)) { radar.tmp1[1,round((tmp1[i,19]-tmp1[i,13]+240)/10-9)%%36+1] = radar.tmp1[1,round((tmp1[i,19]-tmp1[i,13]+240)/10-9)%%36+1]+1 }
    for (i in 1:nrow(tmp2)) { radar.tmp2[1,round((tmp2[i,19]-tmp2[i,13]+240)/10-9)%%36+1] = radar.tmp2[1,round((tmp2[i,19]-tmp2[i,13]+240)/10-9)%%36+1]+1 }
    if (nrow(tmp3) != 0) {for (i in 1:nrow(tmp3)) { radar.tmp3[1,round((tmp3[i,19]-tmp3[i,13]+240)/10-9)%%36+1] = radar.tmp3[1,round((tmp3[i,19]-tmp3[i,13]+240)/10-9)%%36+1]+1 }}
    
    #print("Test 2")
    
    radar.tmp1 = radar.tmp1 / sum(radar.tmp1)*100 ; radar.tmp2 = radar.tmp2 / sum(radar.tmp2)*100 
    if (nrow(tmp3) != 0) {radar.tmp3 = radar.tmp3 / sum(radar.tmp3)*100
    radar.tmp=rbind(rep(30,15) ,rep(0,15) , radar.tmp1, radar.tmp2, radar.tmp3, c(0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0)) }
    else {radar.tmp=rbind(rep(30,15) ,rep(0,15) , radar.tmp1, radar.tmp2, c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0), c(0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,0,0,0,0,0,0))}}
  
  radarchart( radar.tmp  , axistype=1 , 
              pcol=c(rgb(1,0,0,0.9),rgb(0,0,1,0.9),rgb(0,1,0,0.9),rgb(0,0,0)) , pfcol=c(rgb(1,0,0,0.7), rgb(0,0,1,0.5),rgb(0,1,0,0.3),rgb(0,0,0)) , #custom polygon
              cglcol="grey", cglty=1, axislabcol="grey", seg=6, caxislabels=seq(0,30,5), cglwd=0.8, pty = 32, plty=1, plwd=c(1,1,1,3), #custom the grid
              vlcex=0.8 , centerzero=TRUE, #custom labels
              title = "" )
}
```

Delta propre droit et gauche

```{r plot radar 1, echo=FALSE, warning=FALSE, fig.height=4.3, fig.width=4.3, fig.align="center",fig.show="hold"}
layout(matrix(c(1,4,1,2,4,5,2,1,5,3,1,6,3,7,6,1,7,1),nrow=3))
par(oma=c(0,0,0,0)+0.1,mar=c(0,0,0,0)+0.1)

plot.new()

radar3.angle(data, "delta propre", "droit", "aab", "aab delta propre droit")
radar3.angle(data, "delta propre", "droit", "caa", "caa delta propre droit")
radar3.angle(data, "delta propre", "droit", "abb", "abb delta propre droit")
radar3.angle(data, "delta propre", "droit", "bbc", "bbc delta propre droit")
radar3.angle(data, "delta propre", "droit", "bcc", "bcc delta propre droit")
radar3.angle(data, "delta propre", "droit", "cca", "cca delta propre droit")

plot.new()

radar3.angle(data, "delta propre", "gauche", "aab", "aab delta propre gauche")
radar3.angle(data, "delta propre", "gauche", "caa", "caa delta propre gauche")
radar3.angle(data, "delta propre", "gauche", "abb", "abb delta propre gauche")
radar3.angle(data, "delta propre", "gauche", "bbc", "bbc delta propre gauche")
radar3.angle(data, "delta propre", "gauche", "bcc", "bcc delta propre gauche")
radar3.angle(data, "delta propre", "gauche", "cca", "cca delta propre gauche")
```

\newpage
Delta de pouce droit et gauche

```{r plot radar 2, echo=FALSE, warning=FALSE, fig.height=4.3, fig.width=4.3, fig.align="center",fig.show="hold"}
layout(matrix(c(1,4,1,2,4,5,2,1,5,3,1,6,3,7,6,1,7,1),nrow=3))
par(oma=c(0,0,0,0)+0.1,mar=c(0,0,0,0)+0.1)

plot.new()

radar3.angle(data, "delta de pouce", "droit", "aab", "aab delta propre droit")
radar3.angle(data, "delta de pouce", "droit", "caa", "caa delta propre droit")
radar3.angle(data, "delta de pouce", "droit", "abb", "abb delta propre droit")
radar3.angle(data, "delta de pouce", "droit", "bbc", "bbc delta propre droit")
radar3.angle(data, "delta de pouce", "droit", "bcc", "bcc delta propre droit")
radar3.angle(data, "delta de pouce", "droit", "cca", "cca delta propre droit")

plot.new()

radar3.angle(data, "delta de pouce", "gauche", "aab", "aab delta de pouce gauche")
radar3.angle(data, "delta de pouce", "gauche", "caa", "caa delta de pouce gauche")
radar3.angle(data, "delta de pouce", "gauche", "abb", "abb delta de pouce gauche")
radar3.angle(data, "delta de pouce", "gauche", "bbc", "bbc delta de pouce gauche")
radar3.angle(data, "delta de pouce", "gauche", "bcc", "bcc delta de pouce gauche")
radar3.angle(data, "delta de pouce", "gauche", "cca", "cca delta de pouce gauche")
```

\elandscape

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
